# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    nginx.conf                                         :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: tpetros <tpetros@student.42abudhabi.ae>    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2024/01/03 16:23:13 by tpetros           #+#    #+#              #
#    Updated: 2024/01/03 16:23:14 by tpetros          ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

events {}

http
{
    server 
    {
        listen                      443 ssl;
        server_name                 tpetros.42.ae www.tpetros.42.ae;
        root                        /var/www/html;
        index                       index.php index.html index.htm;
        ssl_certificate             /etc/nginx/ssl/tpetros.42.ae.crt;
        ssl_certificate_key         /etc/nginx/ssl/tpetros.42.ae.key;
        ssl_protocols               TLSv1.2 TLSv1.3;
        ssl_session_timeout         10m;
        keepalive_timeout           70;

        access_log                  /var/log/nginx/access.log;
	    error_log                   /var/log/nginx/error.log;


        location / 
        {
            try_files               $uri /index.php?$args /index.html;
            add_header              Last-Modified $date_gmt;
            add_header              Cache-Control 'no-store, no-cache';
            if_modified_since       off;
            expires                 off;
            etag                    off;
        }



        location ~ \.php$ 
        {
            fastcgi_split_path_info     ^(.+\.php)(/.+)$;
            fastcgi_pass                wordpress:9000;
            fastcgi_index               index.php;
            include                     fastcgi_params;
            fastcgi_param               SCRIPT_FILENAME $document_root$fastcgi_script_name;
            fastcgi_param               PATH_INFO $fastcgi_path_info;
        }
    }
}